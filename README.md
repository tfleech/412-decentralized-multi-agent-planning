# 412-multi-agent-2

## Prerequisites
These instructions assume you are running the VM provided for the course [[LINK](https://www.dropbox.com/s/cdfkfk2px8u0u4h/cognitive-robotics-18-vm.ova?dl=0)]

## Install

- Create catkin_ws (chose to make a separate workspace since the one in "managed" might change in the future)
```
mkdir -p ~/catkin_ws/src
```

- Clone repositories into workspace
```
cd ~/catkin_ws/src
git clone git@github.mit.edu:412-multi-agent-2/path_planning.git
git clone git@github.mit.edu:412-multi-agent-2/task_allocation.git
git clone git@github.mit.edu:412-multi-agent-2/412-multi-agent-2.git
```

- Build workspace

```
# using catkin_make
cd ~/catkin_ws
catkin_make

# ALTERNATIVE: using catkin build (recommended, however need to install catkin_tools)
sudo apt install python-catkin-tools
cd ~/catkin_ws
catkin build
```

- Source workspace (recommend adding this line to your ~/.bashrc to avoid having to type this in every new terminal)
```
source ~/catkin_ws/devel/setup.bash
```


## Run

To launch simulation environment (not needed for grand challenge!)
```
roslaunch 412-multi-agent-2 grand_challenge_gazebo.launch
```


To launch our algorithm nodes run this launch file on each turtlebot (assumes each robot is namespacing the topics, which is an argument in the launch file):
```
roslaunch 412-multi-agent-2 single_agent.launch
```
For an example of how we expected namespacing to work for the grand challenge
```
roslaunch 412-multi-agent-2 grand_challenge_algorithms.launch
```

*Subscribed topics:*

- /possible_points
  - message type : sensor_msgs/PointCloud.msg
  - description : points to explore generated by adaptive sampling team
- /map
  - message type : nav_msgs/OccupancyGrid.msg
  - description : occupancy grid generated by SLAM team
- /agent_n/odom
  - message type : geometry_msgs/PoseStamped.msg
  - description : pose of agent generated by SLAM team
  
*Published topics:*

- /agent_n/waypoint
  - message type : geometry_msgs/PoseStamped.msg
  - description : intermediate waypoint to goal location, sent to underactuated team
  
- /agent_n/goal_reached
  - message type : std_msgs/Bool.msg
  - description : flag raised when agent reaches goal location

- /semaphore
  - message type : std_msgs/Bool.msg
  - description : flag raised when we want to query new points from the adaptive sampling team

## Testing
To make sure that RVO is working correctly, we have made a simple node for testing (only) RVO. 
Please follow: 
```
roslaunch 412-multi-agent-2 grand_challenge_algorithms.launch
```
and then
```
roscd path_planning && python script/test_rvo_node.py
```
To test inputs from the adaptive sampling team we made a simple node that generates random points to sample:
```
rosrun 412-multi-agent-2 test_targets_pub.py 
```
